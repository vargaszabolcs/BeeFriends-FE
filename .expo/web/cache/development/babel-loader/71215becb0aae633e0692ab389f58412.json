{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport React, { useState } from \"react\";\nimport InputField from \"../components/login/InputField\";\nimport { SafeAreaView } from \"react-native-safe-area-context\";\nimport SubmitButton from \"../components/login/SubmitButton\";\nimport axios from \"axios\";\nimport Network from \"../constants/Network\";\nimport ExtraLink from \"../components/login/ExtraLink\";\nimport { saveLocalData } from \"../localStorage/storageHelpers\";\nimport { StorageKeys } from \"../localStorage/storageKeys\";\nimport { useDispatch } from \"react-redux\";\nimport { logIn } from \"../store/appSlice\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar SignupScreen = function SignupScreen(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState(\"\"),\n      _useState2 = _slicedToArray(_useState, 2),\n      email = _useState2[0],\n      setEmail = _useState2[1];\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      password = _useState4[0],\n      setPassword = _useState4[1];\n\n  var _useState5 = useState(\"\"),\n      _useState6 = _slicedToArray(_useState5, 2),\n      passwordRepeat = _useState6[0],\n      setPasswordRepeat = _useState6[1];\n\n  var _useState7 = useState(\"\"),\n      _useState8 = _slicedToArray(_useState7, 2),\n      name = _useState8[0],\n      setName = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      isLoading = _useState10[0],\n      setIsLoading = _useState10[1];\n\n  var _useState11 = useState(\"\"),\n      _useState12 = _slicedToArray(_useState11, 2),\n      error = _useState12[0],\n      setError = _useState12[1];\n\n  var dispatch = useDispatch();\n\n  var verifyData = function verifyData(email, password, rePassword, name) {\n    if (email === \"\") {\n      setError(\"Please enter an email address!\");\n      return false;\n    } else {\n      var emailRegex = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n\n      if (!emailRegex.test(email)) {\n        setError(\"Please enter a valid email address!\");\n        return false;\n      }\n    }\n\n    if (password === \"\") {\n      setError(\"Please enter a password!\");\n      return false;\n    } else if (password.length < 6) {\n      setError(\"Please enter a password with at least 6 characters!\");\n      return false;\n    }\n\n    if (rePassword === \"\") {\n      setError(\"Please repeat your password!\");\n      return false;\n    }\n\n    if (name === \"\") {\n      setError(\"Please enter your name!\");\n      return false;\n    } else if (name.length < 3) {\n      setError(\"Please enter a name with at least 3 characters!\");\n      return false;\n    }\n\n    if (password !== rePassword) {\n      setError(\"Passwords do not match!\");\n      return false;\n    }\n\n    return true;\n  };\n\n  var onSubmit = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      setIsLoading(true);\n\n      if (!verifyData(email, password, passwordRepeat, name)) {\n        setIsLoading(false);\n        return;\n      }\n\n      var data = {\n        email: email,\n        password: password,\n        full_name: name\n      };\n\n      try {\n        var response = yield axios.post(Network.API_URL + \"/auth/signup\", data, {\n          timeout: 5000\n        });\n\n        if (response.data.error) {\n          setError(response.data.error);\n        } else {\n          setError(\"\");\n          var userData = {\n            token: response.data.token,\n            email: email,\n            full_name: response.data.full_name\n          };\n          saveLocalData(StorageKeys.USER_DATA, JSON.stringify(userData), true);\n          dispatch(logIn(userData));\n        }\n\n        setIsLoading(false);\n      } catch (err) {\n        setError(\"Something went wrong. Please try again later and check your internet connection!\");\n        console.error(err);\n        setIsLoading(false);\n      }\n    });\n\n    return function onSubmit() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return _jsxs(SafeAreaView, {\n    style: styles.container,\n    children: [_jsx(Text, {\n      style: styles.title,\n      children: \"Sign Up\"\n    }), _jsx(InputField, {\n      value: email,\n      onChangeText: setEmail,\n      isDisabled: isLoading,\n      type: \"email\",\n      placeholder: \"Email\"\n    }), _jsx(InputField, {\n      value: password,\n      onChangeText: setPassword,\n      isDisabled: isLoading,\n      type: \"password\",\n      placeholder: \"Password\"\n    }), _jsx(InputField, {\n      value: passwordRepeat,\n      onChangeText: setPasswordRepeat,\n      isDisabled: isLoading,\n      type: \"password\",\n      placeholder: \"Repeat Password\"\n    }), _jsx(InputField, {\n      value: name,\n      onChangeText: setName,\n      isDisabled: isLoading,\n      type: \"name\",\n      placeholder: \"Name\"\n    }), error ? _jsx(Text, {\n      style: styles.error,\n      children: error\n    }) : null, _jsx(SubmitButton, {\n      text: \"Submit\",\n      onPress: onSubmit,\n      isDisabled: isLoading\n    }), _jsx(ExtraLink, {\n      text: \"I already have an account\",\n      onPress: navigation.goBack\n    })]\n  });\n};\n\nvar styles = StyleSheet.create({\n  container: {\n    alignItems: \"center\"\n  },\n  title: {\n    fontSize: 30,\n    fontWeight: \"bold\",\n    marginBottom: 20\n  },\n  error: {\n    color: \"red\",\n    width: \"90%\"\n  }\n});\nexport default SignupScreen;","map":{"version":3,"names":["React","useState","InputField","SafeAreaView","SubmitButton","axios","Network","ExtraLink","saveLocalData","StorageKeys","useDispatch","logIn","SignupScreen","navigation","email","setEmail","password","setPassword","passwordRepeat","setPasswordRepeat","name","setName","isLoading","setIsLoading","error","setError","dispatch","verifyData","rePassword","emailRegex","test","length","onSubmit","data","full_name","response","post","API_URL","timeout","userData","token","USER_DATA","JSON","stringify","err","console","styles","container","title","goBack","StyleSheet","create","alignItems","fontSize","fontWeight","marginBottom","color","width"],"sources":["D:/DEV/react-native/BeeFriends-FE/src/screens/SignupScreen.tsx"],"sourcesContent":["import { StyleSheet, Text } from \"react-native\";\r\nimport React, { useState } from \"react\";\r\nimport InputField from \"../components/login/InputField\";\r\nimport { SafeAreaView } from \"react-native-safe-area-context\";\r\nimport SubmitButton from \"../components/login/SubmitButton\";\r\nimport axios, { AxiosResponse } from \"axios\";\r\nimport Network from \"../constants/Network\";\r\nimport { IUser, LoginResponse, LoginStackParamList } from \"../types\";\r\nimport ExtraLink from \"../components/login/ExtraLink\";\r\nimport { NativeStackScreenProps } from \"@react-navigation/native-stack\";\r\nimport { saveLocalData } from \"../localStorage/storageHelpers\";\r\nimport { StorageKeys } from \"../localStorage/storageKeys\";\r\nimport { useDispatch } from \"react-redux\";\r\nimport { logIn } from \"../store/appSlice\";\r\n\r\ntype ISignupScreenProps = NativeStackScreenProps<LoginStackParamList, \"Signup\">;\r\n\r\nconst SignupScreen: React.FC<ISignupScreenProps> = ({ navigation }) => {\r\n    const [email, setEmail] = useState(\"\");\r\n    const [password, setPassword] = useState(\"\");\r\n    const [passwordRepeat, setPasswordRepeat] = useState(\"\");\r\n    const [name, setName] = useState(\"\");\r\n\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [error, setError] = useState(\"\");\r\n\r\n    const dispatch = useDispatch();\r\n\r\n    const verifyData = (email: string, password: string, rePassword: string, name: string) => {\r\n        if (email === \"\") {\r\n            setError(\"Please enter an email address!\");\r\n            return false;\r\n        } else {\r\n            const emailRegex =\r\n                /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n            if (!emailRegex.test(email)) {\r\n                setError(\"Please enter a valid email address!\");\r\n                return false;\r\n            }\r\n        }\r\n\r\n        if (password === \"\") {\r\n            setError(\"Please enter a password!\");\r\n            return false;\r\n        } else if (password.length < 6) {\r\n            setError(\"Please enter a password with at least 6 characters!\");\r\n            return false;\r\n        }\r\n\r\n        if (rePassword === \"\") {\r\n            setError(\"Please repeat your password!\");\r\n            return false;\r\n        }\r\n        if (name === \"\") {\r\n            setError(\"Please enter your name!\");\r\n            return false;\r\n        } else if (name.length < 3) {\r\n            setError(\"Please enter a name with at least 3 characters!\");\r\n            return false;\r\n        }\r\n\r\n        if (password !== rePassword) {\r\n            setError(\"Passwords do not match!\");\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    };\r\n\r\n    const onSubmit = async () => {\r\n        setIsLoading(true);\r\n\r\n        if (!verifyData(email, password, passwordRepeat, name)) {\r\n            setIsLoading(false);\r\n            return;\r\n        }\r\n\r\n        const data = { email, password, full_name: name };\r\n        try {\r\n            const response: AxiosResponse<LoginResponse> = await axios.post(\r\n                Network.API_URL + \"/auth/signup\",\r\n                data,\r\n                { timeout: 5000 },\r\n            );\r\n\r\n            if (response.data.error) {\r\n                setError(response.data.error);\r\n            } else {\r\n                setError(\"\");\r\n                const userData: IUser = {\r\n                    token: response.data.token,\r\n                    email: email,\r\n                    full_name: response.data.full_name,\r\n                };\r\n                saveLocalData(StorageKeys.USER_DATA, JSON.stringify(userData), true);\r\n                dispatch(logIn(userData));\r\n            }\r\n            setIsLoading(false);\r\n        } catch (err) {\r\n            setError(\r\n                \"Something went wrong. Please try again later and check your internet connection!\",\r\n            );\r\n            console.error(err);\r\n            setIsLoading(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <SafeAreaView style={styles.container}>\r\n            <Text style={styles.title}>Sign Up</Text>\r\n            <InputField\r\n                value={email}\r\n                onChangeText={setEmail}\r\n                isDisabled={isLoading}\r\n                type=\"email\"\r\n                placeholder=\"Email\"\r\n            />\r\n            <InputField\r\n                value={password}\r\n                onChangeText={setPassword}\r\n                isDisabled={isLoading}\r\n                type=\"password\"\r\n                placeholder=\"Password\"\r\n            />\r\n            <InputField\r\n                value={passwordRepeat}\r\n                onChangeText={setPasswordRepeat}\r\n                isDisabled={isLoading}\r\n                type=\"password\"\r\n                placeholder=\"Repeat Password\"\r\n            />\r\n            <InputField\r\n                value={name}\r\n                onChangeText={setName}\r\n                isDisabled={isLoading}\r\n                type=\"name\"\r\n                placeholder=\"Name\"\r\n            />\r\n            {error ? <Text style={styles.error}>{error}</Text> : null}\r\n            <SubmitButton\r\n                text=\"Submit\"\r\n                onPress={onSubmit}\r\n                isDisabled={isLoading}\r\n            />\r\n            <ExtraLink\r\n                text=\"I already have an account\"\r\n                onPress={navigation.goBack}\r\n            />\r\n        </SafeAreaView>\r\n    );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        alignItems: \"center\",\r\n    },\r\n    title: {\r\n        fontSize: 30,\r\n        fontWeight: \"bold\",\r\n        marginBottom: 20,\r\n    },\r\n    error: {\r\n        color: \"red\",\r\n        width: \"90%\",\r\n    },\r\n});\r\n\r\nexport default SignupScreen;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}